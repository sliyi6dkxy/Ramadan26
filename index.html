<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ØªÙ‡Ù†Ø¦Ø© Ø§Ù„Ø¹ÙŠØ¯ ðŸŽ‰</title>
  <style>
    body {
      background: radial-gradient(circle at top, #222, #000);
      color: #fff;
      font-family: "Tajawal", sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    .container {
      margin-top: 100px;
    }
    input {
      padding: 10px;
      border-radius: 10px;
      border: none;
      width: 220px;
      text-align: center;
      font-size: 18px;
    }
    button {
      padding: 10px 25px;
      margin-top: 10px;
      border-radius: 10px;
      border: none;
      background-color: #ff9800;
      color: white;
      font-size: 18px;
      cursor: pointer;
    }
    button:hover {
      background-color: #ffa726;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸŽŠ ØªÙ‡Ù†Ø¦Ø© Ø§Ù„Ø¹ÙŠØ¯ ðŸŽŠ</h1>
    <div id="registerSection">
      <h3>Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù„ØªØ¨Ø¯Ø£</h3>
      <input type="text" id="username" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§">
      <br>
      <button onclick="registerUser()">ØªØ³Ø¬ÙŠÙ„</button>
      <p id="error" style="color: #f44336;"></p>
    </div>

    <div id="welcomeSection" class="hidden">
      <h2>Ø¹ÙŠØ¯Ùƒ Ù…Ø¨Ø§Ø±Ùƒ ÙŠØ§ <span id="displayName"></span> ðŸŒ™</h2>
      <p>ØªÙ… ØªØ³Ø¬ÙŠÙ„Ùƒ Ø¨Ù†Ø¬Ø§Ø­ âœ…</p>
    </div>
  </div>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbxK9MBsS4CTN6BwL5rGMeGlwh_cCDKih1ggXu8PlNe0jNWVqK7-kNQjqS6jCzGdmsMz/exec";

    // Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø¬Ù„Ø¨ Ø§Ù„Ù€ User ID
    function generateUserID() {
      let userID = localStorage.getItem("userID");
      if (!userID) {
        userID = "user_" + Math.random().toString(36).substr(2, 9);
        localStorage.setItem("userID", userID);
      }
      return userID;
    }

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    function registerUser() {
      const name = document.getElementById("username").value.trim();
      const errorMsg = document.getElementById("error");
      if (!name) {
        errorMsg.textContent = "âŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø£ÙˆÙ„Ø§Ù‹.";
        return;
      }

      const userID = generateUserID();
      const data = new FormData();
      data.append("name", name);
      data.append("userID", userID);

      fetch(scriptURL, { method: "POST", body: data })
        .then(response => response.text())
        .then(result => {
          console.log("ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„:", result);
          localStorage.setItem("username", name);
          showWelcome(name);
        })
        .catch(error => {
          console.error("Ø­Ø¯Ø« Ø®Ø·Ø£:", error);
          errorMsg.textContent = "âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ØŒ Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ù‹Ø§.";
        });
    }

    // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨
    function showWelcome(name) {
      document.getElementById("registerSection").classList.add("hidden");
      document.getElementById("welcomeSection").classList.remove("hidden");
      document.getElementById("displayName").textContent = name;
    }

    // Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
    window.onload = () => {
      const savedName = localStorage.getItem("username");
      if (savedName) {
        showWelcome(savedName);
      }
    };
  </script>
</body>
</html>
